var fileCurrent,preloadTemplate='<div class="pre-load"><div class="flex-center"><div class="loader"></div></div></div>',errorTemplate='<div class="alert-test"><div class="alert-title ecs-icon-times-circle" ></div > ERROR_MSG</div>';function updateViewCount(e,t){$.ajax({url:t,type:"GET",data:{id:e},beforeSend:function(){},success:function(){},error:function(){}})}function updateRateCount(e,t,r){$.ajax({url:r,type:"GET",data:{id:e,viewname:t},beforeSend:function(){},success:function(e){$("#avg-rating-container-ajax").html(e.viewsrc)},error:function(){}})}function search(e){$.ajax({url:"/aj/Search/PreSearch",type:"GET",data:{keyword:e},beforeSend:function(){},success:function(e){e.Ok?$(".search-result-step2 .search-result-history").html(e.Data.viewsrc):($("#error-modal p").text(e.msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"))},error:function(e){$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function addRating(e,t){var r=!0,o=$(e),a=$(t).find(".error-lst"),i=$(t).find(".list-image");$(t).validate({focusCleanup:!0,focusInvalid:!1,errorPlacement:function(e,t){return!1},showErrors:function(e,t){if(r){var o="<div>"+text1+this.numberOfInvalids()+text2+"</div>";$.each(t,function(){o+='<div class="alert-test"><div class="alert-title ecs-icon-times-circle"></div> '+this.message+$(this.element).data("name")+"</div>"}),a.html(o),r=!1}this.defaultShowErrors()},invalidHandler:function(e,t){t.numberOfInvalids()?a.show():a.hide(),r=!0},submitHandler:function(e){r=!0,$.ajax({url:$(t).attr("action"),type:"POST",data:$(t).serialize(),beforeSend:function(){Ecsgroup.showLoading(o)},success:function(e){return setTimeout(function(){o.removeClass("load-more-overlay loading")},1e3),Ecsgroup.hideLoading(),e.Ok?(a.hide(),$(t).trigger("reset"),$(".rating-stars a").removeClass("active"),i.html(""),$(t).find('input[name="ListImage"]').val("[]"),Ecsgroup.Minipopup.open({productClass:" success minipopup-center",message:'<p><i class="demo-icon cus-ok-circled"></i>'+e.Msg+"</p>",template:'<div class="minipopup-box {{productClass}}"><div class="minipopup-body"><div class="minipopup-content">{{message}}</div></div></div>'})):a.html(errorTemplate.replace("ERROR_MSG",e.Msg)).show(),!1},error:function(e){return Ecsgroup.hideLoading(o),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"),!1}})}})}function loadmorerating(e,t,r){var o=$(e),a=o.parent().find("#currentIndex");$.ajax({url:"/aj/Product/LoadmoreRating",type:"GET",data:{productId:t,page:a.val(),pagesize:r},beforeSend:function(){o.addClass("load-more-overlay loading")},success:function(e){$("html, body").animate({scrollTop:$("#rate .col-loadmore > *").last().offset().top-80},500),o.removeClass("load-more-overlay loading"),a.val(e.CurrentPage+1),$("#rate .col-loadmore").append(e.viewsrc),e.CurrentPage>=e.TotalPageCount&&$("#loadmorecmt").hide()},error:function(e){o.removeClass("load-more-overlay loading"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function showreply(e,t){$(".formreply").hide(),$(e).find("textarea").val("").focus(),$(e).show(),$(e).find(".formreply").show(),$(e).find("textarea").val("@"+t+": "),$("html, body").animate({scrollTop:$(e).offset().top-190},200)}function addComment(e,t){var r=!0,o=$(e),a=$(t).find(".error-lst"),i=$(t).find(".list-image");$(t).validate({focusCleanup:!0,focusInvalid:!1,errorPlacement:function(e,t){return!1},showErrors:function(e,t){if(r){var o="<div>"+text1+this.numberOfInvalids()+text2+"</div>";$.each(t,function(){o+='<div class="alert-test"><div class="alert-title ecs-icon-times-circle"></div> '+this.message+$(this.element).data("name")+"</div>"}),a.html(o),r=!1}this.defaultShowErrors()},invalidHandler:function(e,t){t.numberOfInvalids()?a.show():a.hide(),r=!0},submitHandler:function(e){r=!0,$.ajax({url:$(t).attr("action"),type:"POST",data:$(t).serialize(),beforeSend:function(){Ecsgroup.showLoading(o)},success:function(e){return setTimeout(function(){o.removeClass("load-more-overlay loading")},1e3),Ecsgroup.hideLoading(),e.Ok?(a.hide(),$(t).trigger("reset"),i.html(""),$(t).find('input[name="ListImage"]').val("[]"),Ecsgroup.Minipopup.open({productClass:" success minipopup-center",message:'<p><i class="demo-icon cus-ok-circled"></i>'+e.Msg+"</p>",template:'<div class="minipopup-box {{productClass}}"><div class="minipopup-body"><div class="minipopup-content">{{message}}</div></div></div>'})):a.html(errorTemplate.replace("ERROR_MSG",e.Msg)).show(),!1},error:function(e){return Ecsgroup.hideLoading(o),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"),!1}})}})}function loadmorecomment(e,t,r){var o=$(e),a=o.parent().find("#currentIndex");$.ajax({url:"/aj/News/LoadmoreComment",type:"GET",data:{newsid:t,page:a.val(),pagesize:r},beforeSend:function(){o.addClass("load-more-overlay loading")},success:function(e){$("html, body").animate({scrollTop:$("#comment .col-loadmore > *").last().offset().top-80},500),o.removeClass("load-more-overlay loading"),a.val(e.CurrentPage+1),$("#comment .col-loadmore").append(e.viewsrc),e.CurrentPage>=e.TotalPageCount&&$("#loadmorecmt").hide()},error:function(e){o.removeClass("load-more-overlay loading"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function removecmtimg(e){var t=$(e).data("target"),r=$(t).find('input[name="ListImage"]').val(),o=$(e).data("src"),a=JSON.parse(r);a=a.filter(function(e){return e!==o}),$(t).find('input[name="ListImage"]').val(JSON.stringify(a)),$(e).parent().remove()}function DeleteFile(e){$.ajax({url:"/aj/Shared/DeleteFile",type:"POST",data:{path:e},beforeSend:function(){Ecsgroup.showLoading()},success:function(){Ecsgroup.hideLoading()},error:function(){Ecsgroup.hideLoading()}})}function UpdateFile(e,t,r){var o=new FormData,a=e._realInput.files;if(a.length>0)for(var i=0;i<a.length;i++){if(a[i].size>5242880)return alert(text3),-1;o.append("HelpSectionImages"+i,a[i])}$.ajax({url:"/aj/Shared/UploadFile?pathStr=/file/"+(t||"banner")+"/",type:"POST",processData:!1,contentType:!1,data:o,beforeSend:function(){Ecsgroup.showLoading()},success:function(t){Ecsgroup.hideLoading(),t.Ok?(e._chipContainer.insertAdjacentHTML("beforeend",r),e._toggleNoFile(),$(e._realvalueInput).val(t.Data[0]),Ecsgroup.Minipopup.open({productClass:" success minipopup-center",message:'<p><i class="demo-icon cus-ok-circled"></i>'+t.Msg+"</p>",template:'<div class="minipopup-box {{productClass}}"><div class="minipopup-body"><div class="minipopup-content">{{message}}</div></div></div>'}),fileCurrent=e):($("#error-modal p").text(t.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"))},error:function(e){Ecsgroup.hideLoading(),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function UpdateImage(e,t,r,o){var a=new FormData,i=e.files;if(i.length>0)for(var n=0;n<i.length;n++){if(i[n].size>5242880)return alert(text3),-1;a.append("HelpSectionImages"+n,i[n])}$(e).val(""),$.ajax({url:"/aj/Shared/UploadImage?pathStr=/img/"+(r||"banner")+"/",type:"POST",processData:!1,contentType:!1,data:a,beforeSend:function(){Ecsgroup.showLoading()},success:function(e){if(Ecsgroup.hideLoading(),e.Ok){var r='<div class="img-item br-sm"><a href="javascript:" class="img-cmt-js" data-target="'+o+'" data-src="'+e.Data+'" onclick="removecmtimg(this)"><i class="demo-icon cus-cancel"></i></a><img src="'+e.Data+'" alt="" width="150" height="100" loading="lazy"></div>';$(o).find(".list-image").append(r);var a=new Array;$(o).find(".list-image .img-item").each(function(){var e=$(this).find("img").attr("src");a.push(e)}),$(o).find('input[name="'+t+'"]').val(JSON.stringify(a)),Ecsgroup.Minipopup.open({productClass:" success minipopup-center",message:'<p><i class="demo-icon cus-ok-circled"></i>'+e.Msg+"</p>",template:'<div class="minipopup-box {{productClass}}"><div class="minipopup-body"><div class="minipopup-content">{{message}}</div></div></div>'})}else $("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")},error:function(e){$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function addToCart(e,t,r){var o=$(e),a=o.data("id"),i=o.data("current-text"),n=o.data("loading-text"),s=o.data("loading-dot"),l=o.data("producttype"),d=o.parent().find(t).val();o.addClass("load-more-overlay loading").html(s),Ecsgroup.shoppingCart.addItemToCart(a,parseInt(d),l),null!=r?window.location.href=r:(setTimeout(function(){o.html(n).css("pointer-events","none").removeClass("load-more-overlay loading"),Ecsgroup.shoppingCart.showCartInfo()},1e3),setTimeout(function(){o.html(i).css("pointer-events","auto")},2e3))}function addToCartList(e,t,r){var o=$(e),a=o.data("current-text"),i=o.data("loading-text"),n=o.data("loading-dot"),s=JSON.parse($(t).val());o.addClass("load-more-overlay loading").html(n),s.forEach(function(e){Ecsgroup.shoppingCart.addItemToCart(e.ProductId,parseInt(e.Quantity),e.Type)}),null!=r?window.location.href=r:(setTimeout(function(){o.html(i).css("pointer-events","none").removeClass("load-more-overlay loading"),Ecsgroup.shoppingCart.showCartInfo()},1e3),setTimeout(function(){o.html(a).css("pointer-events","auto")},2e3))}function initCompare(e){var t=new Array;null!=window.localStorage.getItem("comparelist")&&(t=JSON.parse(window.localStorage.getItem("comparelist"))),$(e+" .btn-compare").addClass("disabled"),console.log("initCompare loading..."),t.length>0&&$(e+" .btn-compare").length>0?t.forEach(function(t){$(e+' .btn-compare[data-id="'+t.id+'"]').removeClass("ecs-icon-compare").addClass("added ecs-icon-check-solid").attr("href",Ecsgroup.linkCompare)}):$(e+" .btn-compare").removeClass("added ecs-icon-check-solid").addClass("ecs-icon-compare").attr("href","javascript:"),console.log("initCompare complete"),$(e+" .btn-compare").removeClass("disabled")}function updateWishLst(e,t){var r=new Array;null!=window.localStorage.getItem("wishlist")&&(r=JSON.parse(window.localStorage.getItem("wishlist")));var o=$(e);null==r.find((e,r)=>e===t)&&r.push(t),$.ajax({url:"/aj/Account/UpdateWishList",type:"POST",data:{listId:JSON.stringify(r)},beforeSend:function(){o.addClass("load-more-overlay loading")},success:function(e){e.Ok?(o.removeClass("load-more-overlay loading"),$('body .btn-wishlist[data-id="'+t+'"]').removeClass("ecs-icon-heart").addClass("added ecs-icon-heart-full").attr("href",Ecsgroup.linkWishList),Ecsgroup.Minipopup.open({productClass:" success minipopup-center",message:'<p><i class="demo-icon cus-ok-circled"></i>'+e.Msg+"</p>",template:'<div class="minipopup-box {{productClass}}"><div class="minipopup-body"><div class="minipopup-content">{{message}}</div></div></div>'}),window.localStorage.setItem("wishlist",JSON.stringify(r))):(o.removeClass("load-more-overlay loading"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"))},error:function(e){o.removeClass("load-more-overlay loading"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function initHeart(e){console.log("initHeart loading...");var t=new Array;null!=window.localStorage.getItem("wishlist")&&(t=JSON.parse(window.localStorage.getItem("wishlist"))),$(e+" .btn-wishlist").addClass("disabled"),$(e+" .btn-quickview").addClass("disabled"),t.length>0&&$(e+" .btn-wishlist").length>0?(t.forEach(function(t){$(e+' .btn-wishlist[data-id="'+t+'"]').removeClass("ecs-icon-heart").addClass("added ecs-icon-heart-full").attr("href",Ecsgroup.linkWishList)}),console.log("initHeart complete")):$.ajax({url:"/aj/Account/GetHeartStatus",type:"POST",beforeSend:function(){},success:function(t){t.Data&&(t.Data.forEach(function(t){$(e+' .btn-wishlist[data-id="'+t+'"]').removeClass("ecs-icon-heart").addClass("added ecs-icon-heart-full").attr("href",Ecsgroup.linkWishList)}),window.localStorage.setItem("wishlist",JSON.stringify(t.Data)),console.log("initHeart complete"))},error:function(){console.log("initHeart error")}}),$(e+" .btn-wishlist").removeClass("disabled"),$(e+" .btn-quickview").removeClass("disabled")}function selectSku(e,t){let r=$(e),o=r.data("container"),a=parseInt(r.data("attid")),i=parseInt(r.data("attvalid")),n=r.data("productid"),s=$(o+" .btn-wishlist.added").length,l=$(o+" .btn-compare.added").length,d=JSON.parse($(o+" .attrlist-singlesku").val()),c="/aj/Shared/SelectVerProduct?id="+n+"&ver=";urlprodut=r.data("url"),d.forEach(function(e,t){e.ProductAttributeId===a?(c+=(0==t?"":"v")+a+"-"+i,urlprodut+=(0==t?"":"v")+a+"-"+i):(c+=(0==t?"":"v")+e.ProductAttributeId+"-"+e.ProductAttributeValueId,urlprodut+=(0==t?"":"v")+e.ProductAttributeId+"-"+e.ProductAttributeValueId)}),Ecsgroup.isCountDown&&$(o+" .product-countdown").countdown("destroy"),$.ajax({url:c,type:"GET",data:{viewname:t},beforeSend:function(){"#product-popup-ajax"!=o?$(o).addClass("preload-container").append(preloadTemplate):$(o).addClass("shimmer-container")},success:function(e){"#product-popup-ajax"!=o?$(o).removeClass("preload-container").remove(".pre-load"):$(o).removeClass("shimmer-container"),e.Ok?($(o).html(e.Data.viewsrc).find(".product-url").attr("href",urlprodut),setTimeout(function(){Ecsgroup.productSingle(o),Ecsgroup.isCountDown&&Ecsgroup.countDown(o+" .product-countdown"),Ecsgroup.isWishList&&$(o+" .btn-wishlist").removeClass("disabled"),Ecsgroup.isCompare&&$(o+" .btn-compare").removeClass("disabled"),s>0&&$(o+" .btn-wishlist").removeClass("ecs-icon-heart").addClass("added ecs-icon-heart-full").attr("href",Ecsgroup.linkWishList),l>0&&$(o+" .btn-compare").removeClass("ecs-icon-compare").addClass("added ecs-icon-check-solid").attr("href",Ecsgroup.linkCompare)},500),"#product-popup-ajax"!=o&&$("html, body").animate({scrollTop:$(o).offset().top-80},500)):($("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"))},error:function(e){"#product-popup-ajax"!=o?$(o).removeClass("preload-container").remove(".pre-load"):$(o).removeClass("shimmer-container"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function selectSkuDetail(e){var t=$(e),r=$("#product-info .btn-wishlist.added").length,o=$("#product-info .btn-compare.added").length,a=t.data("url"),i=parseInt(t.data("id")),n=parseInt(t.data("valid")),s=JSON.parse($("#attrlisthd").val()),l=window.location.href.split("?")[0]+"?ver=",d="/aj/product/selectverproduct?ver=";s.forEach(function(e,t){e.ProductAttributeId===i?(d+=(0==t?"":"v")+i+"-"+n,l+=(0==t?"":"v")+i+"-"+n):(d+=(0==t?"":"v")+e.ProductAttributeId+"-"+e.ProductAttributeValueId,l+=(0==t?"":"v")+e.ProductAttributeId+"-"+e.ProductAttributeValueId)}),$("#product-info").css("height",$("#product-info").height()+"px"),Ecsgroup.isCountDown&&$("#product-info .product-countdown").countdown("destroy"),$.ajax({url:d,type:"POST",data:{url:a},beforeSend:function(){$("#product-info").addClass("shimmer-container")},success:function(e){$("#product-info").removeClass("shimmer-container"),e.Ok?($("#product-info").html(e.Data.viewsrc).css("height","auto"),$(".url-ajax").each(function(){$(this).data("url")?$(this).attr("href",$(this).data("url")+window.location.href):$(this).attr("href",window.location.href)}),window.history.pushState({state:l,rand:Math.random()},document.title,l),setTimeout(function(){Ecsgroup.isCountDown&&Ecsgroup.countDown("#product-info .product-countdown"),Ecsgroup.isWishList&&$("#product-info .btn-wishlist").removeClass("disabled"),Ecsgroup.isCompare&&$("#product-info .btn-compare").removeClass("disabled"),r>0&&$("#product-info .btn-wishlist").removeClass("ecs-icon-heart").addClass("added ecs-icon-heart-full").attr("href",Ecsgroup.linkWishList),o>0&&$("#product-info .btn-compare").removeClass("ecs-icon-compare").addClass("added ecs-icon-check-solid").attr("href",Ecsgroup.linkCompare)},1e3),$("html, body").animate({scrollTop:$("#product-info").offset().top-80},500),Ecsgroup.stickyContent(".product-sticky-content",Ecsgroup.stickyProductOptions),Ecsgroup.productSingle("#product-info .product-single"),Ecsgroup.initProductSinglePage.init(),Ecsgroup.slider("#product-info .swiper-container"),Ecsgroup.shop.init()):($("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"))},error:function(e){$("#product-info").removeClass("shimmer-container"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function selectThumbSku(e,t,r){let o=e,a="";$.ajax({url:"/aj/Shared/SelectSkuById",type:"GET",data:{skuid:parseInt(t)},beforeSend:function(){o.addClass("shimmer-container")},success:function(e){o.removeClass("shimmer-container"),e.Ok?(a=0!=e.Data.listedprice?'<ins class="new-price price-promoprice">'+e.Data.price.toLocaleString("vi-VN",{style:"currency",currency:"VND"})+'</ins><label class="product-label label-discount"><span>-'+e.Data.percent+"%</span></label>":'<ins class="new-price">'+e.Data.price.toLocaleString("vi-VN",{style:"currency",currency:"VND"})+"</ins>",o.find('input[type="checkbox"]').length>0&&(o.find('input[type="checkbox"]').attr({"data-price":e.Data.price,"data-promprice":e.Data.listedprice,value:t}).prop("checked",!1),Ecsgroup.initProductSinglePage.recommendItems()),o.find(".product-url").attr("href",r+e.Data.url),o.find(".btn-quickview ").attr("data-url",e.Data.url),o.find(".product-price").html(a)):($("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"))},error:function(e){o.removeClass("shimmer-container"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function openProductPopup(e){var t=$(e),r="#product-popup-ajax",o=t.data("id"),a=t.parent().find(".btn-wishlist.added").length,i=t.parent().find(".btn-compare.added").length,n="/aj/Shared/SelectVerProduct?id="+o+"&ver="+t.data("url");$.ajax({url:n,type:"GET",data:{viewname:"_ItemProductPopup"},beforeSend:function(){},success:function(e){e.Ok?($(r).html(e.Data.viewsrc),Ecsgroup.popup([{src:"#product-popup",type:"inline"}],{on:{done:()=>{Ecsgroup.productSingle(r),setTimeout(function(){Ecsgroup.isCountDown&&Ecsgroup.countDown(r+" .product-countdown"),t.removeClass("load-more-overlay loading"),Ecsgroup.isWishList&&$(r+" .btn-wishlist").removeClass("disabled"),Ecsgroup.isCompare&&$(r+" .btn-compare").removeClass("disabled"),a>0&&$(r+" .btn-wishlist").removeClass("ecs-icon-heart").addClass("added ecs-icon-heart-full").attr("href",Ecsgroup.linkWishList),i>0&&$(r+" .btn-compare").removeClass("ecs-icon-compare").addClass("added ecs-icon-check-solid").attr("href",Ecsgroup.linkCompare),$(r).removeClass("shimmer-container")},500)},closing:()=>{Ecsgroup.isCountDown&&$(r+" .product-countdown").countdown("destroy")}}},"quickview")):($("#error-modal p").text(e.msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"))},error:function(e){$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function refreshFilterNews(){var e=$(Ecsgroup.byId("filterform"));e.find('input[name="sort"]').val($("#sortdropdown").val()),e.find('input[name="page"]').val(1),getFilterResultNews()}function loadmoreFilterNews(){var e=$("#filterform"),t=parseInt(e.find('input[name="page"]').val())+1;e.find('input[name="page"]').val(t),e.find('input[name="sort"]').val($("#sortdropdown").val()),getFilterResultNews("loadmore")}function getFilterResultNews(e){var t=$("#filterform"),r=["page","sort"];if("loadmore"===e){var o=$("#list-filter-loadmore > *").last().offset().top;$.ajax({url:t.attr("action"),type:"GET",data:t.serialize()+"&type=loadmore",beforeSend:function(){$("#loadmore").addClass("load-more-overlay loading"),$("#list-filter-loadmore").addClass("shimmer-container")},success:function(e){$("html, body").animate({scrollTop:o+100},500),$("#list-filter-loadmore").append(e.viewsrc).removeClass("shimmer-container"),totalitem="1-"+$("#list-filter-loadmore > *").length+"/"+e.TotalItemCount,$(".readmore-count").text("("+e.itemremaining+")"),$(".totalitem").text(totalitem),t.find('input[name="page"]').val(e.CurrentPage),e.CurrentPage>=e.TotalPageCount&&$("#loadmore").hide(),updateState(r),$("#loadmore").removeClass("load-more-overlay loading")},error:function(e){$("#list-filter-loadmore").removeClass("shimmer-container"),$("#loadmore").removeClass("load-more-overlay loading"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}else $.ajax({url:t.attr("action"),type:"GET",data:t.serialize(),beforeSend:function(){$("#list-filter").addClass("shimmer-container")},success:function(e){$("#list-filter").html(e).removeClass("shimmer-container"),$(".totalitem").text(totalitem),updateState(r)},error:function(e){$("#list-filter").removeClass("shimmer-container"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function refreshFilterProduct(){var e=$(Ecsgroup.byId("filterform")),t=[];if($('#filter input[name="attr"]:checked').each(function(){var e=$(this).val().split("-");if(2==e.length){var r=t.find(function(t){return t.attid==e[0]});r?r.valid.push(e[1]):t.push({attid:e[0],valid:[e[1]]})}}),e.find('input[name="pp"]').val(""),t.length>0){for(var r="",o=0;o<t.length;o++)0!=o&&(r+="v"),r+=t[o].attid+"-"+t[o].valid.join(",");e.find('input[name="pp"]').val(r)}var a=[];$('#filter input[name="brand"]:checked').each(function(){a.push($(this).val())}),e.find('input[name="bp"]').val(""),a.length>0&&e.find('input[name="bp"]').val(a.join(","));var i=[];$('#filter input[name="price"]:checked').each(function(){i.push($(this).val())}),e.find('input[name="pr"]').val(""),i.length>0&&e.find('input[name="pr"]').val(i.join(",")),e.find('input[name="sort"]').val($("#sortdropdown").val()),e.find('input[name="page"]').val(1),getFilterResultProduct()}function loadmoreFilterProduct(){var e=$("#filterform"),t=parseInt(e.find('input[name="page"]').val())+1;e.find('input[name="page"]').val(t),e.find('input[name="sort"]').val($("#sortdropdown").val()),getFilterResultProduct("loadmore")}function getFilterResultProduct(e){var t=$("#filterform"),r=["page","pp","bp","pr","sort"];if(Ecsgroup.isCountDown&&$("#list-filter .product-countdown").countdown("destroy"),"loadmore"===e){var o=$("#list-filter-loadmore > *").last().offset().top;$.ajax({url:t.attr("action"),type:"GET",data:t.serialize()+"&type=loadmore",beforeSend:function(){$("#loadmore").addClass("load-more-overlay loading"),$("#list-filter-loadmore").addClass("shimmer-container")},success:function(e){$("html, body").animate({scrollTop:o},500),$("#list-filter-loadmore").append(e.viewsrc).removeClass("shimmer-container"),$("#list-filter-loadmore .lazyload-bg").each(function(){$(this).css("background-image","url("+$(this).data("bg")+")").removeClass("lazyload-bg").addClass("ls-is-cached lazyloaded")}),setTimeout(function(){Ecsgroup.isCountDown&&Ecsgroup.countDown("#list-filter .product-countdown"),Ecsgroup.isWishList&&initHeart("#list-filter")},1e3),totalitem="1-"+$("#list-filter-loadmore > *").length+"/"+e.TotalItemCount,$(".readmore-count").text("("+e.itemremaining+")"),$(".totalitem").text(totalitem),t.find('input[name="page"]').val(e.CurrentPage),e.CurrentPage>=e.TotalPageCount&&$("#loadmore").hide(),updateState(r),$("#loadmore").removeClass("load-more-overlay loading")},error:function(e){$("#list-filter-loadmore").removeClass("shimmer-container"),$("#loadmore").removeClass("load-more-overlay loading"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}else $.ajax({url:t.attr("action"),type:"GET",data:t.serialize(),beforeSend:function(){$("#list-filter").addClass("shimmer-container"),Ecsgroup.showLoading()},success:function(e){$("html, body").animate({scrollTop:$("#productcat").offset().top-100},500),$("#list-filter").html(e).removeClass("shimmer-container"),$("#list-filter .lazyload-bg").each(function(){$(this).css("background-image","url("+$(this).data("bg")+")").removeClass("lazyload-bg").addClass("ls-is-cached lazyloaded")}),setTimeout(function(){Ecsgroup.isCountDown&&Ecsgroup.countDown("#list-filter .product-countdown"),Ecsgroup.isWishList&&initHeart("#list-filter"),Ecsgroup.isCompare&&initCompare("#list-filter")},1e3),$(".totalitem").text(totalitem),Ecsgroup.hideLoading(),updateState(r)},error:function(e){$("#list-filter").removeClass("shimmer-container"),Ecsgroup.hideLoading(),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function getLocation(){navigator.geolocation?(navigator.geolocation.getCurrentPosition(showPosition),$("#btn-near-location").addClass("active")):($("#error-modal p").text(text4),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"))}function showPosition(e){resetFilterStore();var t=$("#filterform"),r=$("#search-store-from"),o=e.coords.latitude,a=e.coords.longitude;r.find('input[name="lat"]').val(o),r.find('input[name="log"]').val(a),t.find("input[name='lat']").val(o),t.find("input[name='log']").val(a),$(".select-district li").length>1?$('.select-district li[data-value="0"]').trigger("click"):refreshFilterStore()}function refreshDistrictList(){var e=$("#filter input[name='province']:checked").val();$.ajax({url:"/aj/store/RefreshDistrictList",type:"GET",data:{provinceid:e},beforeSend:function(){Ecsgroup.showLoading()},success:function(e){Ecsgroup.hideLoading(),$(".select-district-js").html(e)},error:function(e){Ecsgroup.hideLoading(),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function resetFilterStore(){var e=$("#filterform"),t=$("#search-store-from"),r=e.find('input[name="pagesize"]').val();$("#filter #select-district").val(null),e.find("input").val(null),t.find("input").val(null),t.find('input[name="sort"]').val(0),e.find('input[name="sort"]').val(0),e.find('input[name="pagesize"]').val(r),e.find('input[name="page"]').val(1)}function refreshFilterStore(){var e=$(Ecsgroup.byId("filterform")),t=$("#search-store-from");e.find('input[name="sort"]').val($("#sortdropdown").val());var r=[];$('#filter input[name="province"]:checked').each(function(){r.push($(this).val())}),e.find('input[name="province"]').val(""),t.find('input[name="province"]').val(""),r.length>0&&(e.find('input[name="province"]').val(r),t.find('input[name="province"]').val(r));var o=[];o.push($("#filter #select-district").val()),e.find('input[name="district"]').val(""),t.find('input[name="district"]').val(""),o.length>0&&(e.find('input[name="district"]').val(o),t.find('input[name="district"]').val(o)),e.find('input[name="page"]').val(1),getFilterResultStore()}function getFilterResultStore(e){var t=$("#filterform"),r=["storekey","province","district","lat","log","page","sort"];if("loadmore"===e){var o=$("#list-filter-loadmore > *").last().offset().top;$.ajax({url:t.attr("action"),type:"GET",data:t.serialize()+"&type=loadmore",beforeSend:function(){$("#loadmore").addClass("load-more-overlay loading"),$("#list-filter-loadmore").addClass("shimmer-container")},success:function(e){$("html, body").animate({scrollTop:o+100},500),$("#list-filter-loadmore").append(e.viewsrc).removeClass("shimmer-container"),totalitem="1-"+$("#list-filter-loadmore > *").length+"/"+e.TotalItemCount,$(".readmore-count").text("("+e.itemremaining+")"),$(".totalitem").text(totalitem),t.find('input[name="page"]').val(e.CurrentPage),e.CurrentPage>=e.TotalPageCount&&$("#loadmore").hide(),updateState(r),$("#loadmore").removeClass("load-more-overlay loading")},error:function(e){$("#list-filter-loadmore").removeClass("shimmer-container"),$("#loadmore").removeClass("load-more-overlay loading"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}else $.ajax({url:t.attr("action"),type:"GET",data:t.serialize(),beforeSend:function(){$("#list-filter").addClass("shimmer-container")},success:function(e){$("#list-filter").html(e).removeClass("shimmer-container"),$(".totalitem").text(totalitem),updateState(r)},error:function(e){$("#list-filter").removeClass("shimmer-container"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}function loadmoreSrcoll(){var e=$("#filterform"),t=parseInt(e.find('input[name="page"]').val())+1,r=$("#list-filter-loadmore"),o=["keysearch","page","sort"];e.find('input[name="page"]').val(t),$.ajax({url:e.attr("action"),type:"GET",data:e.serialize()+"&type=loadmore",beforeSend:function(){r.attr("data-load-state","loading"),r.next().hasClass("load-more-overlay")?r.next().addClass("loading"):$('<div class="load-more-overlay loading"></div>').insertAfter(r)},success:function(e){e.CurrentPage>e.TotalPageCount?(r.next().removeClass("loading"),window.removeEventListener("scroll",loadmoreSrcoll,{passive:!0})):(r.attr("data-load-count",e.CurrentPage),setTimeout(function(){r.next().removeClass("loading"),r.append(e.viewsrc),initHeart("#list-filter-loadmore"),initCompare("#list-filter-loadmore"),r.data("load-state","loaded")},500),updateState(o))},error:function(e){$("#error-modal p").text(e.Msg),Ecsgroup.popup({items:{src:"#error-modal"}},"error")}})}function updateState(e){for(var t=$("#filterform").serializeArray(),r="",o=window.location.href.split("?")[0],a=document.title,i=0;i<t.length;i++){var n=t[i];void 0!==n.value&&""!==n.value&&(e.includes(n.name)&&(r+="&"+n.name+"="+n.value))}r=""===(r=r.replace(/(^&)|(&$)/g,""))?o:o+"?"+r,window.history.pushState({state:r,rand:Math.random()},a,r)}function ajaxProduct(e,t,r,o){let a=$(e),i=a.parent(),n=t.split("|"),s=n[0],l=n[1];switch(Ecsgroup.isCountDown&&$(o+" .product-countdown").countdown("destroy"),s){case"productgroup":$.ajax({url:"/aj/Shared/ProductGroupAjax",type:"GET",data:{id:l,viewname:r},beforeSend:function(){i.scrollLeft(a.offset().left-15),a.addClass("active load-more-overlay loading").siblings().removeClass("active"),$(o).addClass("shimmer-container")},success:function(e){e.Ok?(a.removeClass("load-more-overlay loading"),$(o).html(e.Data.viewsrc).removeClass("shimmer-container"),$(o+" .lazyload-bg").each(function(){$(this).css("background-image","url("+$(this).data("bg")+")").removeClass("lazyload-bg").addClass("ls-is-cached lazyloaded")}),setTimeout(function(){Ecsgroup.isCountDown&&Ecsgroup.countDown(o+" .product-countdown"),Ecsgroup.isWishList&&initHeart(o),Ecsgroup.isCompare&&initCompare(o)},1e3)):(a.removeClass("load-more-overlay loading"),$(o).removeClass("shimmer-container"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"))},error:function(e){a.removeClass("load-more-overlay loading"),$(o).removeClass("shimmer-container"),$("#error-modal p").text(e.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")}})}}function validateForm(e,t,r="default"){let o=!0,a=$(t).find(".error-lst");$(t).validate({focusCleanup:!0,focusInvalid:!1,errorPlacement:function(e,t){return!1},showErrors:function(e,t){if(o){let e;switch(r){case"mini":e=text1+this.numberOfInvalids()+text2+"<br>",$.each(t,function(){e+=this.message+$(this.element).data("name")+"<br>"}),$("#error-modal p").html(e);break;default:e="<div>"+text1+this.numberOfInvalids()+text2+"</div>",$.each(t,function(){e+='<div class="alert-test"><div class="alert-title ecs-icon-times-circle"></div> '+this.message+$(this.element).data("name")+"</div>"}),a.html(e)}o=!1}this.defaultShowErrors()},invalidHandler:function(e,t){switch(r){case"mini":t.numberOfInvalids()?Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"):Fancybox.getInstance().close();break;default:t.numberOfInvalids()?a.show():a.hide()}o=!0},submitHandler:function(i){o=!0;var n=$(t).find('*[name="Note"]').val(),s=[];$(t).find(".get-value").each(function(e){var t=$(this).attr("name");if(!["name","email","phonenumber","body","file"].includes(t)&&1!=$(this).prop("readonly")){var r=$(this).data("type"),o=$(this).data("name"),a=$(this).val(),i=$(this).prop("name");6!==r&&7!==r||!1===$(this).is(":checked")&&(a=null),s.push({Name:o,Value:a,Tag:r,Code:i})}}),$.ajax({url:$(t).attr("action"),dataType:"json",method:"POST",data:$(t).serialize()+"&ext="+JSON.stringify(s),beforeSend:function(){$(e).addClass("load-more-overlay loading")},success:function(o){switch($(e).removeClass("load-more-overlay loading"),r){case"mini":return o.Ok?(sendMail(o.Data.id,"/aj/Shared/SendEmail"),Ecsgroup.Minipopup.open({productClass:" success minipopup-center",message:'<p><i class="demo-icon cus-ok-circled"></i>'+o.Msg+"</p>",template:'<div class="minipopup-box {{productClass}}"><div class="minipopup-body"><div class="minipopup-content">{{message}}</div></div></div>'}),$(t).trigger("reset")):($("#error-modal p").text(o.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")),!1;default:return o.Ok?(sendMail(o.Data.id,"/aj/Shared/SendEmail"),a.hide(),$("#success-modal p").text(n),Ecsgroup.popup([{src:"#success-modal",type:"inline"}],{},"error"),$(t).trigger("reset"),void 0!==fileCurrent&&fileCurrent._removeChips()):a.html(errorTemplate.replace("ERROR_MSG",o.Msg)).show(),!1}},error:function(t){return $(e).removeClass("load-more-overlay loading"),$("#error-modal p").text(t.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"),!1}})}})}function validateFormMini(e,t){let r=!0;$(t).validate({focusInvalid:!0,errorPlacement:function(e,t){return!1},showErrors:function(e,t){if(r){var o=text1+this.numberOfInvalids()+text2+"<br>";$.each(t,function(){o+=this.message+$(this.element).data("name")+"<br>"}),$("#error-modal p").html(o),r=!1}this.defaultShowErrors()},invalidHandler:function(e,t){t.numberOfInvalids()?Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"):Fancybox.getInstance().close(),r=!0},submitHandler:function(o){r=!0;var a=[];$(t).find(".get-value").each(function(e){var t=$(this).attr("name");if(!["name","email","phonenumber","body","file"].includes(t)&&1!=$(this).prop("readonly")){var r=$(this).data("type"),o=$(this).data("name"),i=$(this).val(),n=$(this).prop("name");6!==r&&7!==r||!1===$(this).is(":checked")&&(i=null),a.push({Name:o,Value:i,Tag:r,Code:n})}}),$.ajax({url:$(t).attr("action"),dataType:"json",method:"POST",data:$(t).serialize()+"&ext="+JSON.stringify(a),beforeSend:function(){$(e).addClass("load-more-overlay loading")},success:function(r){return $(e).removeClass("load-more-overlay loading"),r.Ok?(sendMail(r.Data.id,"/aj/Shared/SendEmail"),Ecsgroup.Minipopup.open({productClass:" success minipopup-center",message:'<p><i class="demo-icon cus-ok-circled"></i>'+r.Msg+"</p>",template:'<div class="minipopup-box {{productClass}}"><div class="minipopup-body"><div class="minipopup-content">{{message}}</div></div></div>'}),$(t).trigger("reset")):($("#error-modal p").text(r.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error")),!1},error:function(t){return $(e).removeClass("load-more-overlay loading"),$("#error-modal p").text(t.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"),!1}})}})}function sendMail(e,t){$.ajax({url:t,type:"GET",data:{id:e},beforeSend:function(){},success:function(){},error:function(){}})}function validateFormApi(e,t,r){var o=!0,a="https://script.google.com/macros/s/AKfycbytuo2Pld01GVJjZrvlAMywFd6UJsN5Yy9-6SI90tGS9m1nR6aDhOy3yHJOppdo9QEHUg/exec",i=$(t).find(".error-lst");$(t).validate({focusCleanup:!0,focusInvalid:!1,errorPlacement:function(e,t){return!1},showErrors:function(e,t){if(o){var r="<div>"+text1+this.numberOfInvalids()+text2+"</div>";$.each(t,function(){r+='<div class="alert-test"><div class="alert-title ecs-icon-times-circle"></div> '+this.message+$(this.element).data("name")+"</div>"}),i.html(r),o=!1}this.defaultShowErrors()},invalidHandler:function(e,t){t.numberOfInvalids()?i.show():i.hide(),o=!0},submitHandler:function(r){o=!0;var n=$(t).find('*[name="Note"]').val(),s=[];$(t).find(".get-value").each(function(e){var t=$(this).attr("name");if(!["name","email","phonenumber","body","file"].includes(t)){var r=$(this).data("type"),o=$(this).data("name"),a=$(this).val(),i=$(this).prop("name");6!==r&&7!==r||!1===$(this).is(":checked")&&(a=null),s.push({Name:o,Value:a,Tag:r,Code:i})}}),$.ajax({url:a,method:"POST",data:$(t).serialize(),beforeSend:function(){},success:function(e){},error:function(e){}}),$.ajax({url:"https://boldman.vn/aj/StaticPage/ContactApi",dataType:"json",method:"POST",data:$(t).serialize()+"&extentionfield="+JSON.stringify(s),beforeSend:function(){$(e).addClass("load-more-overlay loading")},success:function(r){return $(e).removeClass("load-more-overlay loading"),r.Ok?(sendMailApi(r.Data.id,"https://boldman.vn/aj/staticpage/SendEmailApi","tronghuy2208@gmail.com"),i.hide(),$("#success-modal p").text(n),Ecsgroup.popup([{src:"#success-modal",type:"inline"}],{},"error"),$(t).trigger("reset"),void 0!==fileCurrent&&fileCurrent._removeChips()):i.html(errorTemplate.replace("ERROR_MSG",r.Msg)).show(),!1},error:function(t){return $(e).removeClass("load-more-overlay loading"),$("#error-modal p").text(t.Msg),Ecsgroup.popup([{src:"#error-modal",type:"inline"}],{},"error"),!1}})}})}function sendMailApi(e,t,r){$.ajax({url:t,type:"GET",data:{id:e,emailTo:r},beforeSend:function(){},success:function(){},error:function(){}})}function choselang(e){$.post("/aj/shared/CreateCookie",{lang:e},function(e){e.Ok?alert("Lỗi"):location.reload()})}$(".input-group-effect .form-control").focus(function(e){$(this).parent().addClass("focus")}).blur(function(e){""===$(this).val()&&$(this).parent().removeClass("focus")}),$(document).ajaxSend(function(e,t,r){if("POST"==r.type.toUpperCase()||"PUT"==r.type.toUpperCase()){var o=$("form").find("input[name='__RequestVerificationToken']").val();t.setRequestHeader("RequestVerificationToken",o)}}),setTimeout(function(){Ecsgroup.isWishList&&initHeart("body"),Ecsgroup.isCompare&&initCompare("body")},3e3),$.extend($.validator.messages,{required:validate1,remote:validate2,email:validate3,url:validate4,date:validate5,dateISO:validate6,number:validate7,digits:validate8,creditcard:validate9,equalTo:validate10,accept:validate11,maxlength:$.validator.format(validate12),minlength:$.validator.format(validate13),rangelength:$.validator.format(validate14),range:$.validator.format(validate15),max:$.validator.format(validate16),min:$.validator.format(validate17)});